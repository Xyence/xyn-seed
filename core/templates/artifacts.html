{% extends "base.html" %}

{% block title %}Artifacts - Xyn Seed Core{% endblock %}

{% block content %}
<div class="page-header">
    <h2>Artifact Browser</h2>
    <p class="meta">Files, logs, and outputs from runs</p>
</div>

<div class="filters">
    <div class="form-group" style="margin-bottom: 0;">
        <label for="kind-filter">Filter by Kind</label>
        <select id="kind-filter" onchange="window.location.href='/ui/artifacts?kind='+this.value">
            <option value="">All Kinds</option>
            {% for kind in kinds %}
            <option value="{{ kind }}" {% if kind == selected_kind %}selected{% endif %}>{{ kind }}</option>
            {% endfor %}
        </select>
    </div>
    <div style="display: flex; gap: 0.5rem;">
        <button class="btn btn-secondary" onclick="location.reload()">Refresh</button>
    </div>
</div>

<div class="card">
    {% if artifacts %}
    <table>
        <thead>
            <tr>
                <th>Created At</th>
                <th>Name</th>
                <th>Kind</th>
                <th>Size</th>
                <th>Content Type</th>
                <th>Run</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for artifact in artifacts %}
            <tr>
                <td class="meta">{{ artifact.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                <td><strong>{{ artifact.name }}</strong></td>
                <td><code>{{ artifact.kind }}</code></td>
                <td class="meta">{{ (artifact.byte_length / 1024) | round(2) if artifact.byte_length else 0 }} KB</td>
                <td class="meta">{{ artifact.content_type }}</td>
                <td>
                    {% if artifact.run_id %}
                    <a href="/ui/runs/{{ artifact.run_id }}">View Run</a>
                    {% else %}
                    <span class="meta">-</span>
                    {% endif %}
                </td>
                <td>
                    <a href="/ui/artifacts/{{ artifact.id }}" class="btn btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.875rem;">Details</a>
                    <a href="/api/v1/artifacts/{{ artifact.id }}/download" class="btn btn-primary" style="padding: 0.25rem 0.5rem; font-size: 0.875rem;">Download</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <p>No artifacts found</p>
    </div>
    {% endif %}
</div>
{% endblock %}
